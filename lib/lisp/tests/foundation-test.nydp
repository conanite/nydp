(register-test '(suite "Foundation Tests"
  (suite "strings"
    (suite "type-of"
      ("returns 'string"
        (type-of "foobar")
        string)

      ("interpolates a string"
        "foobar %%(+ 1 2) you know"
        "foobar 3 you know")

      ("returns 'string for an interpolated string"
        (type-of "foobar %%(+ 1 2)")
        string)

))
  (suite "Lists"
    (suite "cons"
      ("cons creates a list"
        (cons 'a '(b c))
        (a b c))

      ("cons conses two strings"
        (cons "a" "b")
        ("a" . "b"))

      ("len returns length of proper list"
        (len (cons "a" (cons "b" nil)))
        2)

      ("type-of returns pair"
        (type-of (cons "a" "b"))
        pair))

    (suite "car"
      ("car of nil is nil"
        (car nil)
        nil)

      ("car of empty list is nil"
        (car '())
        nil)

      ("car - no need to quote empty list"
        (car ())
        nil)

      ("car returns car of argument"
        (car '(foo 12.34 "bar"))
        foo)
    ))))
